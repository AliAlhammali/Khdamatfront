import{i as _,v as y,u as v,F as l,w as b,L as c}from"./geosearch.module-C3uEVW0W.js";import{_ as C,r as s,o as L,c as w,b as M,a as r,w as i,g as k,F as x}from"./index-CS9bw-lj.js";const B={props:{editMode:{type:Boolean,default:!1},lat:{type:Number,default:null},long:{type:Number,default:null}},components:{LMap:_,LTileLayer:y,LMarker:v},data(){return{center:[47.41322,-1.219482],zoom:14,address:{title:"",lat:null,long:null}}},mounted(){this.$nextTick(()=>{this.initMap()}),this.editMode?this.center=[this.lat,this.long]:this.getLocation()},methods:{getLocation(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(e=>{this.center=[e.coords.latitude,e.coords.longitude],this.findAddressByCoordinates()})},updateCenter(e){this.center=[e.target._latlng.lat,e.target._latlng.lng],this.findAddressByCoordinates()},searchLocation(e){new l().search({query:e}).then(a=>{const o=a.find(n=>n.label.includes(e));this.address={title:o?.raw?.display_name||o?.label,lat:o?.raw?.lat||o?.y,long:o?.raw?.lon||o?.x},this.$emit("getLocation",this.address)})},initMap(){const e=new l({params:{countrycodes:"SA"}}),t=new b({provider:e,notFoundMessage:"Sorry, that address could not be found.",searchLabel:"البحث",style:"bar"}),a=new c.Map("leafletmap");a.addControl(t),a.on("geosearch/showlocation",o=>{this.center=[o.location.y,o.location.x],a.eachLayer(n=>{n instanceof c.Marker&&a.removeLayer(n)}),this.findAddressByCoordinates()})},findAddressByCoordinates(){const e=new l;fetch(`${e.searchUrl}?q=${this.center[0]},${this.center[1]}&polygon_geojson=1&format=json`).then(t=>t.json()).then(t=>{this.address={title:t[0]?.display_name,lat:t[0]?.lat,long:t[0]?.lon},this.$emit("getLocation",this.address)})}},watch:{center:{handler(){this.findAddressByCoordinates()},deep:!0}}},A={class:"position-relative",id:"leafletmap"};function z(e,t,a,o,n,d){const p=s("l-tile-layer"),h=s("l-marker"),m=s("l-map"),g=s("v-icon"),u=s("v-btn");return L(),w(x,null,[M("div",A,[r(m,{ref:"map",zoom:n.zoom,center:n.center,"global-leaflet":!1,style:{height:"400px"}},{default:i(()=>[r(p,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png","layer-type":"base",name:"OpenStreetMap"}),r(h,{"lat-lng":n.center,"update:visible":!0,draggable:"",onDragend:t[0]||(t[0]=f=>d.updateCenter(f))},null,8,["lat-lng"])]),_:1},8,["zoom","center"])]),r(u,{onClick:d.getLocation,fab:"",color:"primary",class:"mt-4"},{default:i(()=>[r(g,{size:"24"},{default:i(()=>[k(" mdi mdi-crosshairs-gps")]),_:1})]),_:1},8,["onClick"])],64)}const F=C(B,[["render",z]]);export{F as M};
//# sourceMappingURL=Maps-Cb9r27sT.js.map
